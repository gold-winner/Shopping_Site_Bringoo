<div *ngIf="isExpand$|async as expand" class="blank h-100p" [class.isOpen]="expand === 'open'">  <div    *ngIf="expand === 'open'"    class="h-100p w-100p panel border-round-sm bg-component"    @expand    (@expand.done)="onEndAnimation($event)"  >    <div class="d-flex justify-content-between pr-4 pl-5 pt-2 pb-2 panel-header">      <div class="d-inline">        <i nz-icon class="mr-2" nzType="info-circle" nzTheme="outline"></i> <h4 class="d-inline">Routes Details</h4>      </div>      <button class="close-button" nz-button [nzType]="'text'" (click)="onCompressPanel()">        <i nz-icon nzType="close" nzTheme="outline"></i>      </button>    </div>    <ul nz-menu nzMode="inline" class="menu" [nzTheme]="'light'">      <li nz-submenu nzTitle="Route Select">        <ul>          <li nz-menu-item nzSelected style="padding-left: 0; padding-right: 0; display: block">            <app-order-details-filter-form></app-order-details-filter-form>          </li>        </ul>      </li>    </ul>    <div class="border-bottom map-controls px-4">      <button        nz-button        nzType="link"        nzSize="small"        (click)="onShowOnMap()"      >Show On Map</button>      <button        nz-button        nzType="link"        nzSize="small"        (click)="onShowSelected()"      >Show Selected</button>    </div>      <div class="f-4 px-4 route-header border-bottom bg-darkvanilla-10">        <ng-container *ngIf="route$|async as activeRoute">          <div class="d-flex justify-content-between">            <p class="mb-0 text-bold text-overflow scroll-hidden">{{activeRoute.name}}</p>            <button              nz-button              nzType="link"              nzSize="small"              (click)="updateRouteForm.onShowForm(activeRoute)"            ><i nz-icon nzType="edit" class="color-primary" nzTheme="outline"></i></button>          </div>          <p class="mb-0 f-3 text-bold text-overflow scroll-hidden">{{activeRoute.code}}</p>          <p class="mb-0 f-3 text-bold text-overflow scroll-hidden">Driver: {{activeRoute.driver.firstName}} {{activeRoute.driver.lastName}}</p>          <div class="d-flex justify-content-between">            <div class="text-center">              <h4><a>{{activeRoute.totalPoints}}</a></h4>              <p class="mb-0"><b>Items</b></p>            </div>            <div class="text-center">              <h4><a>{{activeRoute.totalBreaks}}</a></h4>              <p class="mb-0"><b>Breaks</b></p>            </div>            <div class="text-center">              <h4><a>{{activeRoute.totalPickUp}}</a></h4>              <p class="mb-0"><b>Pick Up</b></p>            </div>            <div class="text-center">              <h4><a>{{activeRoute.totalDropOff}}</a></h4>              <p class="mb-0"><b>Drop Off</b></p>            </div>            <div class="text-center">              <h4><a>{{activeRoute.totalRefuel}}</a></h4>              <p class="mb-0"><b>Refuel</b></p>            </div>          </div>          <nz-modal            [nzVisible]="openAssignDriverForm === 'open'"            nzTitle="Assign Driver"            (nzOnCancel)="onCloseAssignDriver()"            (nzOnOk)="onAssignDriver()"          >            <h5 *nzModalContent>              Assign              <a routerLink="/users/staff/details/{{activeRoute.driver.id}}">                {{activeRoute.driver.firstName}} {{activeRoute.driver.lastName}}                ({{activeRoute.driver.staffNumber}})              </a>              to route orders            </h5>          </nz-modal>        </ng-container>      </div>      <div class="h-100p overflow-hidden">        <app-route-details-drop-zone          [showOnMap]="showOnMap"          [showSelected]="showSelected"          [errorOrderNumber]="pointWithError$|async"          [onCreateRouteItem]="createRouteItem"          [deletePoints]="deletePoints"          (onCheckedMany)="onCheckedMany($event)"        ></app-route-details-drop-zone>      </div>    <div class="d-flex justify-content-center py-4 flex-column px-4 panel-footer">      <button        nz-button        nzType="primary"        class="bg-lightblue border-round-md"        [disabled]="isDisabledAssignDriverButton$|async"        (click)="onOpenAssignDriver()"      >Assign Driver</button>      <button        nz-button        nzType="primary"        class="bg-lightblue border-round-md mt-2"        [disabled]="isDisabledCreateButton$|async"        (click)="onCreateRouteItem()"      >Create Route Item</button>      <button        nz-button        nzType="primary"        class="bg-danger border-round-md mt-2"        [disabled]="!isManyChecked"        nzDanger        (click)="onDeletePoints()"      >Delete Points</button>    </div>  </div>  <div    class="button border-round-sm cursor-pointer bg-component"    *ngIf="expand !== 'open'"    (click)="onExpandPanel()"  >    <i nz-icon nzType="info-circle" nzTheme="outline"></i>  </div></div><nz-drawer  [nzVisible]="openPanel === 'updateRoute'"  nzPlacement="right"  nzTitle="Update Route {{updateRouteForm.routeName}}"  [nzWidth]="500"  (nzOnClose)="onClosePanel()"  [nzFooter]="updateRoutePanelFooter">  <ng-container *nzDrawerContent>    <div>      <div        *ngIf="isLoading$|async"        class="form-modal"      ></div>      <ng-template        [ngComponentOutlet]="updateRouteForm.form"        [ndcDynamicInputs]="updateRouteForm.formInputs"        [ndcDynamicOutputs]="updateRouteForm.formOutputs"      ></ng-template>    </div>  </ng-container></nz-drawer><ng-template #updateRoutePanelFooter>  <div class="container">    <div class="row">      <div class="col-12">        <button (click)="onClosePanel()" nzBlock nz-button nzType="link">Cancel</button>      </div>      <div class="col-12">        <button [nzLoading]="isLoading$ | async" (click)="updateRouteForm.onButtonClick()" nzBlock nz-button nzType="primary">          Update        </button>      </div>    </div>  </div></ng-template>